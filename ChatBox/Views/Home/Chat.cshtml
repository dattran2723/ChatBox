@using Microsoft.AspNet.Identity
@model IEnumerable<ChatBox.ViewModel.UserViewModel>
@{
    ViewBag.Title = "Chat";
    Layout = null;
}
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>@ViewBag.Title - ChatBox</title>
    <link href="~/Imgs/icon.png" type="image/png" rel="shortcut icon" />
    <link href="~/Content/bootstrap.min.css" rel="stylesheet" />
    <link href="~/fontawesome-free-5.7.1-web/css/all.css" rel="stylesheet" />
    <link href="~/Content/chat.css" rel="stylesheet" />
</head>
<body>
    <div class="wrapper">
        <div class="header row">
            <div class="title left col-4">
                <p>Quản lý tin nhắn</p>
            </div>
            <div class="avatar right col-8">
                <div class="dropdown float-right">
                    <div class="d-flex bd-highlight dropdown-toggle" data-toggle="dropdown">
                        <div class="img_cont">
                            <img src="https://devilsworkshop.org/files/2013/01/enlarged-facebook-profile-picture.jpg" class="rounded-circle user_img">
                            <span class="online"></span>
                        </div>
                        <div class="user_info">
                            <span>@User.Identity.GetUserName()</span>
                            <p>Quản trị viên</p>
                        </div>
                    </div>
                    <div class="dropdown-menu">
                        @using (Html.BeginForm("LogOff", "Account", FormMethod.Post, new { id = "logoutForm", @class = "navbar-right" }))
                        {
                            @Html.AntiForgeryToken()
                            <a href="javascript:document.getElementById('logoutForm').submit()" class="dropdown-item">Đăng xuất</a>
                        }
                    </div>
                </div>
            </div>
        </div>
        <div class="content row">
            <div class="content-left col-4">
                <div class="box-item content-title total-contact">
                    <p>
                        <i class="far fa-user"></i> <member></member> <span>Người sử dụng</span> <br />
                        <i class="fas fa-circle"></i> <online></online>  <span>Đang hoạt động</span>
                    </p>
                </div>
                <div class="box-item box-search">
                    <input type="text" name="search" value="" placeholder="Search" class="form-control search" />
                </div>
                <ul class="list-contacts p-0">
                    @foreach (var item in Model)
                    {
                        <li class="box-item contact">
                            <div class="d-flex bd-highlight w-100">
                                <div class="img_cont">
                                    <img src="https://devilsworkshop.org/files/2013/01/enlarged-facebook-profile-picture.jpg" class="rounded-circle user_img">
                                    <span class="@(item.IsOnline == true ? "online": "")"></span>
                                </div>
                                <div class="user_info">
                                    <span class="user-name">@item.Email</span>
                                    <input type="hidden" name="connectionId" value="@item.ConnectionId" />
                                    <p>@(item.LastMsg.Length > 20 ? item.LastMsg.Substring(0, 20) + "..." : item.LastMsg) </p>
                                </div>
                                <div class="time">
                                    <p>Yesterday</p>
                                </div>
                            </div>
                        </li>
                    }
                </ul>
            </div>
            <div class="content-right col-8">
                <div class="content-title chat-header row">
                    <div class="col-6">
                        <span class="user-active"></span>
                        <i class="fas fa-circle"></i>
                        <input type="hidden" name="connectionIdActive" value="" />
                    </div>
                    <div class="col-6 text-right">
                        <div class="">
                            <button type="button" class="btn btn-outline-dark"><i class="fas fa-upload"></i></button>
                            <button type="button" class="btn btn-outline-dark"><i class="far fa-trash-alt"></i></button>
                        </div>
                    </div>
                </div>
                <div class="chat-content">
                    <ul class="list-messages">
                    </ul>
                    <div class="input-group box-group">
                        <div class="input-group-prepend">
                            <button class="btn"><i class="fas fa-paper-plane"></i></button>
                        </div>
                        <textarea class="form-control" placeholder="Nhập nội dung tin nhắn"></textarea>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script src="~/Scripts/jquery-3.3.1.min.js"></script>
    <script src="~/Scripts/popper.js"></script>
    <script src="~/Scripts/bootstrap.min.js"></script>
    <script src="~/Scripts/jquery.signalR-2.2.2.js"></script>
    <script src="~/signalr/hubs"></script>
    <script src="~/Scripts/testManage.js"></script>
    <script>
        $(document).ready(function () {
            if (window.matchMedia('(max-width: 1000px)').matches) {
                $(".contact").each(function () {
                    var name = $(this).find('.user_info span').text();
                    var img = $(this).find('img');
                    img.attr('data-toggle', 'tooltip');
                    img.attr('title', name);
                });
                $('[data-toggle="tooltip"]').tooltip();
            }
        })
    </script>
</body>
</html>